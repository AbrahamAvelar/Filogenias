# Quiero agregar cepas que permitan ver mejor las cosas cerca de la de morelos, la de oaxaca y las de tamaulipas que dan con las del mundo
# Las de Tmps dan muy cercanas a Mosaic Region 3 de California y de Canadá
# La de Morelos sale cercana a 23. North American Oax
# Las de tamaulipas con Mixed origin, panadera para ver si sale con ellas.


# 00_Download
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/00_download
vim  /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv # :set nobomb
module load python37/3.7.0
python3.7 download_sra.py -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv

cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/00_download
mv javelar_SH_download_SRA.sh javelar_SH_download_SRA_SACE37.sh
bash javelar_SH_download_SRA_SACE37.sh

# 02_Cleaning
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/02_cleaning
module load python37/3.7.0
python3.7 clean_fastq.py -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/02_cleaning
bash  javelar_SH_clean_fastq.sh

# 03_Mapping  # de aquí a 05_vcalling había corrido SAPA como referencia :| lo tengo que volver a hacer.
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/03_mapping
module load python37/3.7.0
python3.7 mapping2ref.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/03_mapping
mv javelar_SH_map2ref.sh javelar_SH_map2ref_SACE37EcuAndNAOak.sh
bash javelar_SH_map2ref_SACE37EcuAndNAOak.sh
#se fueron los 37 trabajos! 17:15 - 23:35

#04_coverage # 13:25-22:30 SAPA- - - 23:44
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/04_coverage
module load python37/3.7.0
python3.7 coverage_plot.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/04_coverage
mv javelar_SH_coverage_plot.sh javelar_SH_coverage_plot_SACE37_AddEcuadorAndNAOak.sh
bash javelar_SH_coverage_plot_SACE37_AddEcuadorAndNAOak.sh
# como una muestra no había terminado el 03 cuando  lancé los trabajos 04 entonces repetí el 04 ya al día siguiente
# qsub ERR1309203_SACE.sge

# 05_vcalling ~22hrs - 17:30 SAPA :: 9:53- SACE
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 vcalling_genotyping_isolates_GATK.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
exit 
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/05_vcalling
mv  javelar_SH_vcalling_genotyping.sh  javelar_SH_vcalling_genotyping_SACE37_AddEcuadorAndNAOak.sh
bash javelar_SH_vcalling_genotyping_SACE37_AddEcuadorAndNAOak.sh


# 05_vcalling OnlyChr
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 SNPs_onlyChr.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv --subgenome SACE
exit
mv javelar_SH_vcfOnlychr.sh javelar_SH_vcfOnlychr_SACE37_AddEcuadorAndNAOak.sh
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/05_vcalling
bash javelar_SH_vcfOnlychr_SACE37_AddEcuadorAndNAOak.sh

# como se quedó atrás el 04_coverage de la SRR7500223 avancé con lo demás y generé a nueva sample sheet sin esa usando vim
# también le quité espacios al final a las dos columnas que decian SRR1868670
/mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SAPA146_WorldANDNatEnvMezcal.csv

