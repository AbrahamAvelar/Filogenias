# Quiero agregar cepas que permitan ver mejor las cosas cerca de la de morelos, la de oaxaca y las de tamaulipas que dan con las del mundo
# Las de Tmps dan muy cercanas a Mosaic Region 3 de California y de Canadá
# La de Morelos sale cercana a 23. North American Oax
# Las de tamaulipas con Mixed origin, panadera para ver si sale con ellas.


# 00_Download
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/00_download
vim  /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv # :set nobomb
module load python37/3.7.0
python3.7 download_sra.py -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv

cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/00_download
mv javelar_SH_download_SRA.sh javelar_SH_download_SRA_SACE37.sh
bash javelar_SH_download_SRA_SACE37.sh

# 02_Cleaning
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/02_cleaning
module load python37/3.7.0
python3.7 clean_fastq.py -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/02_cleaning
bash  javelar_SH_clean_fastq.sh

# 03_Mapping  # de aquí a 05_vcalling había corrido SAPA como referencia :| lo tengo que volver a hacer.
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/03_mapping
module load python37/3.7.0
python3.7 mapping2ref.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/03_mapping
mv javelar_SH_map2ref.sh javelar_SH_map2ref_SACE37EcuAndNAOak.sh
bash javelar_SH_map2ref_SACE37EcuAndNAOak.sh
#se fueron los 37 trabajos! 17:15 - 23:35

#04_coverage # 13:25-22:30 SAPA- - - 23:44
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/04_coverage
module load python37/3.7.0
python3.7 coverage_plot.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/04_coverage
mv javelar_SH_coverage_plot.sh javelar_SH_coverage_plot_SACE37_AddEcuadorAndNAOak.sh
bash javelar_SH_coverage_plot_SACE37_AddEcuadorAndNAOak.sh
# como una muestra no había terminado el 03 cuando  lancé los trabajos 04 entonces repetí el 04 ya al día siguiente
# qsub ERR1309203_SACE.sge

# 05_vcalling ~22hrs - 17:30 SAPA :: 9:53-17:43 SACE
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 vcalling_genotyping_isolates_GATK.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv
exit 
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/05_vcalling
mv  javelar_SH_vcalling_genotyping.sh  javelar_SH_vcalling_genotyping_SACE37_AddEcuadorAndNAOak.sh
bash javelar_SH_vcalling_genotyping_SACE37_AddEcuadorAndNAOak.sh


# 05_vcalling OnlyChr 17:44-
qlogin
cd /mnt/Timina/lmorales/Public/ymez/bin/scripts/05_vcalling
module load python37/3.7.0
python3.7 SNPs_onlyChr.py -r /mnt/Timina/lmorales/Public/ymez/data/metadata/ref_only_SACE.txt -s /mnt/Timina/lmorales/Public/ymez/data/metadata/SampleSheet_SACE37_AddEcuadorAndNAOak.csv --subgenome SACE
exit
cd /mnt/Timina/lmorales/Public/ymez/bin/SGE/05_vcalling
mv javelar_SH_vcfOnlychr.sh javelar_SH_vcfOnlychr_SACE37_AddEcuadorAndNAOak.sh
bash javelar_SH_vcfOnlychr_SACE37_AddEcuadorAndNAOak.sh


#Voy a preparar la sample sheet sin híbridos y con las de ecuador
#mxSACE_plus_HYB_2tree_26jul2022.csv # 236total - 30JS  146SACE_YMX 20Hyb   2BRA 16CIATEJ     14CELG   7LAC   1ALPechin  
#onlySACE2tree_26jul2022.csv         # 362total - 167JS 169YMX              18BR  7DK-CIATEJ                  1ALPechin
#SACES2tree_21jul2022.csv            # 391total - 168JS 146SACE_YMX 20Hyb   18BR  16CIATEJ    14CELG   7LAC   1ALPechin
#SampleSheet_SACE174_OnlyMX.csv      # 174total - 37JS+1
#SampleSheet_SACE360_from26jul22.csv # a esta le quité el híbrido de brasil y otra que estaba repetida. a esta le voy a agregar las 37 de ecuador y etc


#Generé  SampleSheet_SACE395_SACE360from26jul22ADDEcuadorAndNAOak.csv Para el árbol #Aquí agregué la de tina con >300 introgresiones
#Para admixture partir de /mnt/Timina/lmorales/Public/ymez/tmp/06_genotyping/trees/SACE304


